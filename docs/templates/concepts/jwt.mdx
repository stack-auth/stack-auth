---
title: JWT Tokens
---

JSON Web Tokens (JWT) are a compact, URL-safe means of representing claims to be transferred between two parties. Stack Auth uses JWTs for secure authentication and authorization.

## What is a JWT?

A JWT is a string that consists of three parts separated by dots (`.`):

1. **Header**: Contains metadata about the token, such as the signing algorithm
2. **Payload**: Contains the claims (data) about the user or entity
3. **Signature**: Used to verify the token's authenticity

The structure looks like this: `header.payload.signature`

## JWT Viewer

Use the interactive JWT viewer below to decode and inspect JWT tokens. If you're signed in, it will automatically load and display your current session token:

<JWTViewer />

## Stack Auth JWT Structure

Stack Auth JWTs contain specific claims that are used throughout the authentication system:

### Standard Claims

- **`iss` (Issuer)**: The Stack Auth server that issued the token
- **`sub` (Subject)**: The user ID this token represents
- **`aud` (Audience)**: The intended recipient of the token (your project)
- **`exp` (Expiration)**: When the token expires (Unix timestamp)
- **`iat` (Issued At)**: When the token was issued (Unix timestamp)
- **`nbf` (Not Before)**: When the token becomes valid (Unix timestamp)

### Stack Auth Specific Claims

- **`userId`**: The unique identifier for the user
- **`projectId`**: Your Stack Auth project ID
- **`role`**: The user's role (`user`, `admin`, etc.)
- **`teamId`**: The current team context (if applicable)
- **`permissions`**: Array of permissions granted to the user
- **`branchId`**: The project branch (typically `main`)

## Example JWT Payload

Here's what a typical Stack Auth JWT payload looks like:

```json
{
  "iss": "https://api.stack-auth.com",
  "sub": "user_123456",
  "aud": "project_abcdef:main",
  "exp": 1735689600,
  "iat": 1735603200,
  "userId": "user_123456",
  "projectId": "project_abcdef",
  "role": "user",
  "teamId": "team_789",
  "permissions": ["read", "write"],
  "branchId": "main"
}
```

## Working with JWTs

### Client-Side Usage

Stack Auth automatically handles JWT tokens for you. When you use hooks like `useUser()`, the JWT is automatically included in API requests:

```tsx
import { useUser } from '@stackframe/stack';

export function UserProfile() {
  const user = useUser();
  
  if (!user) {
    return <div>Please sign in</div>;
  }
  
  return <div>Welcome, {user.displayName}!</div>;
}
```

### Server-Side Usage

On the server side, you can access the JWT and its claims through the Stack Auth API:

```tsx
import { stackServerApp } from '@/stack';

export async function GET() {
  const user = await stackServerApp.getUser();
  
  if (!user) {
    return new Response('Unauthorized', { status: 401 });
  }
  
  // Access user information from the JWT
  return Response.json({
    userId: user.id,
    displayName: user.displayName,
    // Other user properties...
  });
}
```

### Manual JWT Verification

If you need to manually verify a JWT (for example, in a different service), you can use the public key endpoint:

```typescript
import * as jose from 'jose';

// Get the public key set from Stack Auth
const jwks = jose.createRemoteJWKSet(
  new URL('https://api.stack-auth.com/api/latest/projects/YOUR_PROJECT_ID/jwks')
);

// Verify the JWT
try {
  const { payload } = await jose.jwtVerify(token, jwks, {
    issuer: 'https://api.stack-auth.com',
    audience: 'YOUR_PROJECT_ID:main',
  });
  
  console.log('JWT is valid:', payload);
} catch (error) {
  console.error('JWT verification failed:', error);
}
```

## Security Considerations

### Token Storage

- **Never store JWTs in localStorage** for sensitive applications
- Use secure, httpOnly cookies when possible
- Stack Auth handles secure token storage automatically

### Token Expiration

- JWTs have a limited lifetime (typically 1 hour)
- Stack Auth automatically refreshes tokens before they expire
- Always check the `exp` claim when manually handling JWTs

### Signature Verification

- Always verify JWT signatures using the public key
- Never trust the contents of a JWT without verification
- Stack Auth SDKs handle verification automatically

## Troubleshooting

### Common Issues

1. **"JWT is expired"**: The token has passed its expiration time. Stack Auth will automatically refresh it.

2. **"Invalid signature"**: The token was tampered with or signed with a different key.

3. **"Invalid audience"**: The token was issued for a different project or environment.

### Debugging JWTs

Use the JWT viewer above to inspect tokens and verify their contents. Pay special attention to:

- Expiration times (`exp` claim)
- Audience (`aud` claim) matching your project
- Required claims are present

## Best Practices

1. **Let Stack Auth handle tokens**: Use the provided SDKs instead of manual JWT handling
2. **Validate on the server**: Always verify JWTs on your backend
3. **Check expiration**: Ensure tokens haven't expired before using them
4. **Use HTTPS**: Always transmit JWTs over secure connections
5. **Monitor token usage**: Log authentication events for security monitoring

## Related Concepts

- [API Keys](/docs/concepts/api-keys) - Alternative authentication method for server-to-server communication
- [Backend Integration](/docs/concepts/backend-integration) - How to verify JWTs in your backend
- [Permissions](/docs/concepts/permissions) - Understanding the permissions claim in JWTs
