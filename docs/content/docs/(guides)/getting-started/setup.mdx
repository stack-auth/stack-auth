---
title: Setup
---

<Info>
The Stack Auth Docs contain code examples for various languages and frameworks. You can select the language and framework in any codeblock.
</Info>

## Setup

Stack Auth supports multiple platforms and frameworks. Choose your preferred language and framework from the dropdown in the code examples below.

### Prerequisites

Before getting started, make sure you have a project set up for your chosen platform:

- **Next.js**: A [Next.js project](https://nextjs.org/docs/getting-started/installation) using the app router (Stack Auth does not support the pages router on Next.js)
- **React**: A [React project](https://react.dev/learn/creating-a-react-app) (we show examples with Vite)
- **JavaScript**: A Node.js project with Express
- **Python**: A Python environment with your chosen framework (Django, FastAPI, or Flask)

We recommend using our **setup wizard** for JavaScript frameworks for a seamless installation experience. For Python, we recommend using the REST API approach.

<Tabs defaultValue="wizard">
  <TabsList>
    <TabsTrigger value="wizard">Setup wizard (recommended for JS)</TabsTrigger>
    <TabsTrigger value="manual">Manual installation</TabsTrigger>
  </TabsList>
  
  <TabsContent value="wizard">
    <Steps>
      <Step>
      ### Run installation wizard
      </Step>
      
      <Info>
        The setup wizard is available for JavaScript/TypeScript frameworks. For Python projects, please use the manual installation method.
      </Info>

      Run Stack's installation wizard with the following command:

      ```sh title="Terminal"
      npx @stackframe/init-stack@latest
      ```

      <Step>
      ### Update API keys
      </Step>
      
      Create an account on [the Stack Auth dashboard](https://app.stack-auth.com/projects), create a new project with an API key, and copy its environment variables into the appropriate configuration file:

      <PlatformCodeblock
        platforms={{
          "JavaScript": {
            "Next.js": {
              code:`NEXT_PUBLIC_STACK_PROJECT_ID=<your-project-id>
NEXT_PUBLIC_STACK_PUBLISHABLE_CLIENT_KEY=<your-publishable-client-key>
STACK_SECRET_SERVER_KEY=<your-secret-server-key>`,
              language: "bash",
              filename: ".env.local"
            },
            "React": {
              code: `// Update the values in stack/client.ts created by the wizard
export const stackClientApp = new StackClientApp({
  projectId: "your-project-id",
  publishableClientKey: "your-publishable-client-key",
  tokenStore: "cookie",
});`,
              language: "typescript",
              filename: "stack/client.ts"
            },
            "JavaScript": {
              code: `STACK_PROJECT_ID=<your-project-id>
STACK_PUBLISHABLE_CLIENT_KEY=<your-publishable-client-key>
STACK_SECRET_SERVER_KEY=<your-secret-server-key>`,
              language: "bash",
              filename: ".env"
            }
          }
        }}
        defaultPlatform="JavaScript"
        defaultFrameworks={{ "JavaScript": "Next.js" }}
        title="Environment Configuration"
      />

      <Step>
      ### Done!
      </Step>
      That's it! The wizard should have created or updated the following files in your project:

      **For Next.js:**
      - `app/handler/[...stack]/page.tsx`: Default pages for sign-in, sign-out, account settings, and more
      - `app/layout.tsx`: Updated to wrap the entire body with `StackProvider` and `StackTheme`
      - `app/loading.tsx`: Suspense boundary for Stack's async hooks
      - `stack/server.ts`: Contains the `stackServerApp` for server-side usage
      - `stack/client.ts`: Contains the `stackClientApp` for client-side usage

      **For React:**
      - `stack/client.ts`: Contains the `stackClientApp` configuration
      - Your app should be wrapped with `StackProvider` and `StackTheme`

      **For Node.js/Express:**
      - `stack/server.ts`: Contains the `stackServerApp` configuration
    </Steps>
  </TabsContent>
  
  <TabsContent value="manual">
    <Info>
      Note: The setup wizard also supports existing, complicated projects. Cases where manual installation is necessary are rare for JavaScript frameworks.
    </Info>

    <Steps>
      <Step>
      ### Install package
      </Step>
      
      First, install the appropriate Stack package:

      <PlatformCodeblock
        platforms={{
          "JavaScript": {
            "Next.js": {
              code: "npm install @stackframe/stack",
              language: "bash",
              filename: "Terminal"
            },
            "React": {
              code: "npm install @stackframe/react",
              language: "bash",
              filename: "Terminal"
            },
            "Express": {
              code: "npm install @stackframe/js",
              language: "bash",
              filename: "Terminal"
            },
            "Node.js": {
              code: "npm install @stackframe/js",
              language: "bash",
              filename: "Terminal"
            }
          },
          "Python": {
            "Django": {
              code: "pip install requests",
              language: "bash",
              filename: "Terminal"
            },
            "FastAPI": {
              code: "pip install requests",
              language: "bash",
              filename: "Terminal"
            },
            "Flask": {
              code: "pip install requests",
              language: "bash",
              filename: "Terminal"
            }
          }
        }}
        defaultPlatform="JavaScript"
        defaultFrameworks={{ "JavaScript": "Next.js", "Python": "Django" }}
        title="Package Installation"
      />

      <Step>
      ### Create API keys
      </Step>
      
      [Register a new account on Stack](https://app.stack-auth.com/handler/sign-up), create a project in the dashboard, create a new API key from the left sidebar, and copy the project ID, publishable client key, and secret server key.

      <Step>
      ### Configure environment variables
      </Step>
      
      Set up your environment variables or configuration:

      <PlatformCodeblock
        platforms={{
          "JavaScript": {
            "Next.js": {
              code: `NEXT_PUBLIC_STACK_PROJECT_ID=<your-project-id>
NEXT_PUBLIC_STACK_PUBLISHABLE_CLIENT_KEY=<your-publishable-client-key>
STACK_SECRET_SERVER_KEY=<your-secret-server-key>`,
              language: "env",
              filename: ".env.local"
            },
            "React": {
              code: `# Store these in environment variables or directly in the client file during development
VITE_STACK_PROJECT_ID=<your-project-id>
VITE_STACK_PUBLISHABLE_CLIENT_KEY=<your-publishable-client-key>`,
              language: "env",
              filename: ".env"
            },
            "Express": {
              code: `STACK_PROJECT_ID=<your-project-id>
STACK_PUBLISHABLE_CLIENT_KEY=<your-publishable-client-key>
STACK_SECRET_SERVER_KEY=<your-secret-server-key>`,
              language: "env",
              filename: ".env"
            },
            "Node.js": {
              code: `STACK_PROJECT_ID=<your-project-id>
STACK_PUBLISHABLE_CLIENT_KEY=<your-publishable-client-key>
STACK_SECRET_SERVER_KEY=<your-secret-server-key>`,
              language: "env",
              filename: ".env"
            }
          },
          "Python": {
            "Django": {
              code: `import os

stack_project_id = os.getenv("STACK_PROJECT_ID")
stack_publishable_client_key = os.getenv("STACK_PUBLISHABLE_CLIENT_KEY")
stack_secret_server_key = os.getenv("STACK_SECRET_SERVER_KEY")`,
              language: "python",
              filename: "settings.py"
            },
            "FastAPI": {
              code: `import os

stack_project_id = os.getenv("STACK_PROJECT_ID")
stack_publishable_client_key = os.getenv("STACK_PUBLISHABLE_CLIENT_KEY")
stack_secret_server_key = os.getenv("STACK_SECRET_SERVER_KEY")`,
              language: "python",
              filename: "main.py"
            },
            "Flask": {
              code: `import os

stack_project_id = os.getenv("STACK_PROJECT_ID")
stack_publishable_client_key = os.getenv("STACK_PUBLISHABLE_CLIENT_KEY")
stack_secret_server_key = os.getenv("STACK_SECRET_SERVER_KEY")`,
              language: "python",
              filename: "app.py"
            }
          }
        }}
        defaultPlatform="JavaScript"
        defaultFrameworks={{ "JavaScript": "Next.js", "Python": "Django" }}
        title="Environment Configuration"
      />

      <Step>
      ### Create Stack configuration
      </Step>
      
      Create the Stack app configuration:

      <PlatformCodeblock
        platforms={{
          "JavaScript": {
            "Next.js": {
              server: {
                code: `import "server-only";
      import { StackServerApp } from "@stackframe/stack";

      export const stackServerApp = new StackServerApp({
        tokenStore: "nextjs-cookie", // storing auth tokens in cookies
});`,
                language: "typescript",
                filename: "stack/server.ts"
              },
              client: {
                code: `import { StackClientApp } from "@stackframe/stack";

export const stackClientApp = new StackClientApp({
  // Environment variables are automatically read
});`,
                language: "typescript",
                filename: "stack/client.ts"
              }
            },
            "React": {
              code: `import { StackClientApp } from "@stackframe/react";
// If you use React Router, uncomment the next line and the redirectMethod below
// import { useNavigate } from "react-router-dom";

export const stackClientApp = new StackClientApp({
  projectId: process.env.VITE_STACK_PROJECT_ID || "your-project-id",
  publishableClientKey: process.env.VITE_STACK_PUBLISHABLE_CLIENT_KEY || "your-publishable-client-key",
  tokenStore: "cookie",
  // redirectMethod: { useNavigate }, // Optional: only if using react-router-dom
});`,
              language: "typescript",
              filename: "stack/client.ts"
            },
            "Express": {
              server: {
                code: `import { StackServerApp } from "@stackframe/js";

export const stackServerApp = new StackServerApp({
  projectId: process.env.STACK_PROJECT_ID,
  publishableClientKey: process.env.STACK_PUBLISHABLE_CLIENT_KEY,
  secretServerKey: process.env.STACK_SECRET_SERVER_KEY,
  tokenStore: "memory",
});`,
                language: "typescript",
                filename: "stack/server.ts"
              },
              client: {
                code: `import { StackClientApp } from "@stackframe/js";

export const stackClientApp = new StackClientApp({
  projectId: process.env.STACK_PROJECT_ID,
  publishableClientKey: process.env.STACK_PUBLISHABLE_CLIENT_KEY,
  tokenStore: "cookie",
});`,
                language: "typescript",
                filename: "stack/client.ts"
              }
            },
            "Node.js": {
              server: {
                code: `import { StackServerApp } from "@stackframe/js";

export const stackServerApp = new StackServerApp({
  projectId: process.env.STACK_PROJECT_ID,
  publishableClientKey: process.env.STACK_PUBLISHABLE_CLIENT_KEY,
  secretServerKey: process.env.STACK_SECRET_SERVER_KEY,
  tokenStore: "memory",
});`,
                language: "javascript",
                filename: "stack/server.js"
              },
              client: {
                code: `import { StackClientApp } from "@stackframe/js";

export const stackClientApp = new StackClientApp({
  projectId: process.env.STACK_PROJECT_ID,
  publishableClientKey: process.env.STACK_PUBLISHABLE_CLIENT_KEY,
  tokenStore: "cookie",
});`,
                language: "javascript",
                filename: "stack/client.js"
              }
            }
          },
          "Python": {
            "Django": {
              code: `import requests

def stack_auth_request(method, endpoint, **kwargs):
    res = requests.request(
        method,
        f'https://api.stack-auth.com/{endpoint}',
        headers={
            'x-stack-access-type': 'server',  # or 'client' if you're only accessing the client API
            'x-stack-project-id': stack_project_id,
            'x-stack-publishable-client-key': stack_publishable_client_key,
            'x-stack-secret-server-key': stack_secret_server_key,  # not necessary if access type is 'client'
            **kwargs.pop('headers', {}),
        },
        **kwargs,
    )
    if res.status_code >= 400:
        raise Exception(f"Stack Auth API request failed with {res.status_code}: {res.text}")
    return res.json()`,
              language: "python",
              filename: "views.py"
            },
            "FastAPI": {
              code: `import requests

def stack_auth_request(method, endpoint, **kwargs):
    res = requests.request(
        method,
        f'https://api.stack-auth.com/{endpoint}',
        headers={
            'x-stack-access-type': 'server',  # or 'client' if you're only accessing the client API
            'x-stack-project-id': stack_project_id,
            'x-stack-publishable-client-key': stack_publishable_client_key,
            'x-stack-secret-server-key': stack_secret_server_key,  # not necessary if access type is 'client'
            **kwargs.pop('headers', {}),
        },
        **kwargs,
    )
    if res.status_code >= 400:
        raise Exception(f"Stack Auth API request failed with {res.status_code}: {res.text}")
    return res.json()`,
              language: "python",
              filename: "main.py"
            },
            "Flask": {
              code: `import requests

def stack_auth_request(method, endpoint, **kwargs):
    res = requests.request(
        method,
        f'https://api.stack-auth.com/{endpoint}',
        headers={
            'x-stack-access-type': 'server',  # or 'client' if you're only accessing the client API
            'x-stack-project-id': stack_project_id,
            'x-stack-publishable-client-key': stack_publishable_client_key,
            'x-stack-secret-server-key': stack_secret_server_key,  # not necessary if access type is 'client'
            **kwargs.pop('headers', {}),
        },
        **kwargs,
    )
    if res.status_code >= 400:
        raise Exception(f"Stack Auth API request failed with {res.status_code}: {res.text}")
    return res.json()`,
              language: "python",
              filename: "app.py"
            }
          }
        }}
        defaultPlatform="JavaScript"
        defaultFrameworks={{ "JavaScript": "Next.js", "Python": "Django" }}
        title="Stack Configuration"
      />

      <Step>
      ### Set up authentication handlers (JavaScript frameworks only)
      </Step>
      
      For JavaScript frameworks, create the authentication handler:

      <PlatformCodeblock
        platforms={{
          "JavaScript": {
            "Next.js": {
              code: `import { StackHandler } from "@stackframe/stack";
      import { stackServerApp } from "@/stack/server";

      export default function Handler(props: unknown) {
        return <StackHandler fullPage app={stackServerApp} routeProps={props} />;
}`,
              language: "typescript",
              filename: "app/handler/[...stack]/page.tsx"
            },
            "React": {
              code: `import { StackHandler, StackProvider, StackTheme } from "@stackframe/react";
      import { Suspense } from "react";
      import { BrowserRouter, Route, Routes, useLocation } from "react-router-dom";
      import { stackClientApp } from "./stack/client";

      function HandlerRoutes() {
        const location = useLocation();
        return (
          <StackHandler app={stackClientApp} location={location.pathname} fullPage />
        );
      }

      export default function App() {
        return (
          <Suspense fallback={null}>
            <BrowserRouter>
              <StackProvider app={stackClientApp}>
                <StackTheme>
                  <Routes>
                    <Route path="/handler/*" element={<HandlerRoutes />} />
                    <Route path="/" element={<div>hello world</div>} />
                  </Routes>
                </StackTheme>
              </StackProvider>
            </BrowserRouter>
          </Suspense>
        );
}`,
              language: "typescript",
              filename: "App.tsx"
            },
            "Express": {
              code: `// Express doesn't use built-in handlers
// Use the REST API or integrate with your frontend`,
              language: "typescript",
              filename: "Note"
            },
            "Node.js": {
              code: `// Node.js doesn't use built-in handlers
// Use the REST API or integrate with your frontend`,
              language: "javascript",
              filename: "Note"
            }
          }
        }}
        defaultPlatform="JavaScript"
        defaultFrameworks={{ "JavaScript": "Next.js" }}
        title="Authentication Handlers"
      />

      <Step>
      ### Add providers (Next.js and React only)
      </Step>

      For Next.js and React, wrap your app with Stack providers:

      <PlatformCodeblock
        platforms={{
          "JavaScript": {
            "Next.js": {
              code: `import React from "react";
import { StackProvider, StackTheme } from "@stackframe/stack";
import { stackServerApp } from "@/stack/server";

export default function RootLayout({ children }: { children: React.ReactNode }) {
  return (
    <html lang="en">
      <body>
        <StackProvider app={stackServerApp}>
          <StackTheme>
            {children}
          </StackTheme>
        </StackProvider>
      </body>
    </html>
  );
}`,
              language: "typescript",
              filename: "app/layout.tsx"
            },
            "React": {
              code: `// Already shown in the App.tsx example above
// Make sure to wrap your app with StackProvider and StackTheme`,
              language: "typescript",
              filename: "Note"
            }
          }
        }}
        defaultPlatform="JavaScript"
        defaultFrameworks={{ "JavaScript": "Next.js" }}
        title="App Providers"
      />

      <Step>
      ### Add loading boundary (Next.js only)
      </Step>
      
      For Next.js, add a Suspense boundary:

      <PlatformCodeblock
        platforms={{
          "JavaScript": {
            "Next.js": {
              code: `export default function Loading() {
  // You can use any loading indicator here
  return <>
    Loading...
  </>;
}`,
              language: "typescript",
              filename: "app/loading.tsx"
            }
          }
        }}
        defaultPlatform="JavaScript"
        defaultFrameworks={{ "JavaScript": "Next.js" }}
        title="Loading Component"
      />

      <Step>
      ### Done!
      </Step>
    </Steps>
  </TabsContent>
</Tabs>

## Post-setup

That's it! Stack is now configured in your project. 

### Testing your setup

<PlatformCodeblock
  platforms={{
    "JavaScript": {
      "Next.js": {
        code: `# Start your Next.js app
npm run dev

# Navigate to the sign-up page
# http://localhost:3000/handler/sign-up`,
        language: "bash",
        filename: "Terminal"
      },
      "React": {
        code: `# Start your React app
npm run dev

# Navigate to the sign-up page
# http://localhost:5173/handler/sign-up`,
        language: "bash",
        filename: "Terminal"
      },
      "Express": {
        code: `# Start your Express server
npm start

# Use the REST API or integrate with your frontend
# Check the REST API documentation for endpoints`,
        language: "bash",
        filename: "Terminal"
      },
      "Node.js": {
        code: `# Start your Node.js app
node index.js

# Use the REST API or integrate with your frontend
# Check the REST API documentation for endpoints`,
        language: "bash",
        filename: "Terminal"
      }
    },
    "Python": {
      "Django": {
        code: `# Test the Stack Auth API connection
print(stack_auth_request('GET', '/api/v1/projects/current'))

# Start your Django server
python manage.py runserver`,
        language: "python",
        filename: "Terminal"
      },
      "FastAPI": {
        code: `# Test the Stack Auth API connection
print(stack_auth_request('GET', '/api/v1/projects/current'))

# Start your FastAPI server
uvicorn main:app --reload`,
        language: "python",
        filename: "Terminal"
      },
      "Flask": {
        code: `# Test the Stack Auth API connection
print(stack_auth_request('GET', '/api/v1/projects/current'))

# Start your Flask server
flask run`,
        language: "python",
        filename: "Terminal"
      }
    }
  }}
  defaultPlatform="JavaScript"
  defaultFrameworks={{ "JavaScript": "Next.js", "Python": "Django" }}
  title="Testing Your Setup"
/>

### What you'll see

For JavaScript frameworks with built-in UI components, you'll see the Stack Auth sign-up page:

<div className="stack-white-image-showcase stack-350h">
  <img src="/imgs/sign-in.png" alt="SignIn" />
</div>

After signing up/in, you will be redirected back to the home page. You can also check out the account settings page.

![Stack account settings page](/imgs/account-settings.png)

For Python and backend-only JavaScript setups, you'll interact with Stack Auth through the REST API.

## Example usage

Here are some basic usage examples for each platform:

<PlatformCodeblock
  platforms={{
    "JavaScript": {
      "Next.js": {
        server: {
          code: `import { stackServerApp } from "@/stack/server";

// In a Server Component or API route
const user = await stackServerApp.getUser();
if (user) {
  console.log("User is signed in:", user.displayName);
} else {
  console.log("User is not signed in");
}`,
          language: "typescript",
          filename: "Server Component"
        },
        client: {
          code: `'use client';
import { useUser } from "@stackframe/stack";

export default function MyComponent() {
  const user = useUser();
  
  if (user) {
    return <div>Hello, {user.displayName}!</div>;
  } else {
    return <div>Please sign in</div>;
  }
}`,
          language: "typescript",
          filename: "Client Component"
        }
      },
      "React": {
        code: `import { useUser } from "@stackframe/react";

export default function MyComponent() {
  const user = useUser();
  
  if (user) {
    return <div>Hello, {user.displayName}!</div>;
  } else {
    return <div>Please sign in</div>;
  }
}`,
        language: "typescript",
        filename: "Component"
      },
      "Express": {
        code: `import { stackServerApp } from "./stack/server.js";

app.get('/profile', async (req, res) => {
  try {
    // Get access token from request headers
    const accessToken = req.headers['x-stack-access-token'];
    const user = await stackServerApp.getUser({ accessToken });
    
    if (user) {
      res.json({ message: \`Hello, \${user.displayName}!\` });
    } else {
      res.status(401).json({ error: 'Not authenticated' });
    }
  } catch (error) {
    res.status(500).json({ error: 'Server error' });
  }
});`,
        language: "typescript",
        filename: "server.ts"
      },
      "Node.js": {
        code: `import { stackServerApp } from "./stack/server.js";

async function checkUser(accessToken) {
  try {
    const user = await stackServerApp.getUser({ accessToken });
    
    if (user) {
      console.log(\`Hello, \${user.displayName}!\`);
    } else {
      console.log('User not authenticated');
    }
  } catch (error) {
    console.error('Error:', error);
  }
}`,
        language: "javascript",
        filename: "index.js"
      }
    },
    "Python": {
      "Django": {
        code: `# In your views.py
def profile_view(request):
    # Get access token from request headers
    access_token = request.headers.get('X-Stack-Access-Token')
    
    try:
        user_data = stack_auth_request('GET', '/api/v1/users/me', headers={
            'x-stack-access-token': access_token,
        })
        return JsonResponse({'message': f"Hello, {user_data['displayName']}!"})
    except Exception as e:
        return JsonResponse({'error': 'Not authenticated'}, status=401)`,
        language: "python",
        filename: "views.py"
      },
      "FastAPI": {
        code: `from fastapi import FastAPI, Header, HTTPException

app = FastAPI()

@app.get("/profile")
async def get_profile(x_stack_access_token: str = Header(None)):
    if not x_stack_access_token:
        raise HTTPException(status_code=401, detail="Access token required")
    
    try:
        user_data = stack_auth_request('GET', '/api/v1/users/me', headers={
            'x-stack-access-token': x_stack_access_token,
        })
        return {"message": f"Hello, {user_data['displayName']}!"}
    except Exception as e:
        raise HTTPException(status_code=401, detail="Not authenticated")`,
        language: "python",
        filename: "main.py"
      },
      "Flask": {
        code: `from flask import Flask, request, jsonify

app = Flask(__name__)

@app.route('/profile')
def profile():
    access_token = request.headers.get('X-Stack-Access-Token')
    
    if not access_token:
        return jsonify({'error': 'Access token required'}), 401
    
    try:
        user_data = stack_auth_request('GET', '/api/v1/users/me', headers={
    'x-stack-access-token': access_token,
        })
        return jsonify({'message': f"Hello, {user_data['displayName']}!"})
    except Exception as e:
        return jsonify({'error': 'Not authenticated'}), 401`,
        language: "python",
        filename: "app.py"
      }
    }
  }}
  defaultPlatform="JavaScript"
  defaultFrameworks={{ "JavaScript": "Next.js", "Python": "Django" }}
  title="Basic Usage Examples"
/>

## Next steps

Next up, we will show you how to [retrieve and update user information](./users.mdx), and how to [protect a page](./users.mdx#protecting-a-page) from unauthorized access.

For Python developers, check out the [REST API documentation](../rest-api/overview.mdx) to learn more about the available endpoints and how to use them in your Python application.
